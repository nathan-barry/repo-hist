<!-- Commits Column -->
<div class="col-span-2">
    <h1 class="font-semibold mb-4 text-xl">Commits</h1>
    <div id="commitsList" class="border border-github-dark rounded-lg bg-github-dark">
        {{ range $index, $rc := .RawCommits }}
        <button 
            hx-post="/fetch-dir" 
            hx-target="#dir" 
            hx-vals='{"url": "{{.URL}}"}' 
            onClick="highlightCommit(this)"
            class="commit-button block p-3 w-full text-left hover:bg-github-dark-secondary border-b border-github-dark truncate {{ if eq $index 0 }}bg-github-dark-secondary{{end}}"
        >
            {{$rc.Commit.Message}}
        </button>
        {{end}}
    </div>
</div>

<!-- Current File -->
<div id="file" class="col-span-8 overflow-x-auto">
    <h1 class="font-semibold mb-4 text-xl text-github-dark">{{.Path}}</h1>
    <div class="border border-github-dark rounded-lg p-4 bg-github-dark">
        <div class="flex">
            <button onclick="selectFile()" class="select-file-button block px-3 py-1 text-left hover:bg-github-dark-secondary bg-github-dark-secondary rounded-l border border-github-dark">File</button>
            <button onclick="selectChanges()" class="select-changes-button block px-3 py-1 text-left hover:bg-github-dark-secondary rounded-r border-l-0 border border-github-dark">Changes</button>
        </div>
        <div class="file-content">
            <pre><code class="hidden">{{ .File }}</code></pre>
        </div>
        <div class="file-changes hidden">
            <pre><code class="hidden">{{ .FirstPatch }}</code></pre>
        </div>
    </div>
    <script> hljs.highlightAll(); </script>

</div>

<!-- Files Column -->
<div class="col-span-2">
    <h1 class="font-semibold mb-4 text-xl">Files</h1>
    <div id="dir" class="border border-github-dark rounded-lg bg-github-dark">
        {{ range $index, $tree := .Tree }}
            {{ if eq $tree.URL "deleted" }} 
                <button 
                    class="file-button block p-3 w-full text-left hover:bg-github-dark-secondary border-b border-github-dark"
                >
                    {{$tree.Path}}
                    <span class="text-github-dark-red">deleted</span>
                </button>
            {{ else }}
                <button 
                    hx-post="/fetch-file" 
                    hx-target="#file" 
                    hx-vals='{"url": "{{.URL}}", "path": "{{.Path}}", "patch": "{{.Patch}}"}' 
                    onclick="highlightFile(this)"
                    class="file-button block p-3 w-full text-left hover:bg-github-dark-secondary border-b border-github-dark {{if eq $index 0}}bg-github-dark-secondary{{end}}"
                >
                    {{$tree.Path}}
                    
                    {{ if $tree.Deletions }} 
                        <span class="text-github-dark-red">-{{$tree.Deletions}}</span>
                    {{end}}
                    {{ if $tree.Additions }}
                        <span class="text-github-dark-green">+{{$tree.Additions}}</span>
                    {{end}}
                </button>
            {{end}}
        {{end}}
    </div>
</div>
